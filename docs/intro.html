<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Intro til R og Tidyverse – Kursusmateriale til Virksomhedsstrategi i et netværksperspektiv</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-553db639d176b1f1e5eb8f34e19f9014.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Kursusmateriale til Virksomhedsstrategi i et netværksperspektiv</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Install_guide.html"> 
<span class="menu-text">Install and setup R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./intro.html" aria-current="page"> 
<span class="menu-text">Intro til R og Tidyverse</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./kursusmateriale.html"> 
<span class="menu-text">Kursusmateriale</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduktion" id="toc-introduktion" class="nav-link active" data-scroll-target="#introduktion">Introduktion</a></li>
  <li><a href="#installér-og-indlæs-pakker" id="toc-installér-og-indlæs-pakker" class="nav-link" data-scroll-target="#installér-og-indlæs-pakker">Installér og indlæs pakker</a></li>
  <li><a href="#tidyverse" id="toc-tidyverse" class="nav-link" data-scroll-target="#tidyverse">Tidyverse</a>
  <ul class="collapse">
  <li><a href="#tidyverse-grammatikken" id="toc-tidyverse-grammatikken" class="nav-link" data-scroll-target="#tidyverse-grammatikken">Tidyverse-grammatikken</a>
  <ul class="collapse">
  <li><a href="#læs-data-og-assign--" id="toc-læs-data-og-assign--" class="nav-link" data-scroll-target="#læs-data-og-assign--">Læs data og assign ‘&lt;-’</a></li>
  <li><a href="#databehandling-med-dplyr" id="toc-databehandling-med-dplyr" class="nav-link" data-scroll-target="#databehandling-med-dplyr">Databehandling med dplyr</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Intro til R og Tidyverse</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduktion" class="level1">
<h1>Introduktion</h1>
<p>Det følgende r-scripts er skrevet med afsæt i <strong>R version 4.5.2 (2025-10-31)</strong>. Hvis I ikke allerede har installeret denne seneste version så følg guiden i <a href="Install_guide.html">Install and setup R</a></p>
<p>Det er desuden en god ide at have downloadet zip-filen med r-projektet <em>virkstrat_netvaerk</em> her:</p>
<p><a href="data/virkstrat.zip" class="btn btn-primary">Download Data</a></p>
<p>eller fra kursets canvas-side.</p>
<p>Den fil indeholder følgende filer og mapper:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screenshot from 2025-02-03 20-33-04.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Indhold af zip-filen</figcaption>
</figure>
</div>
<p>(og skal i øvrigt opdateres med filer, jeg løbende lægger op på Canvas):</p>
<p>Download zip-filen og pak den ud et fornuftigt sted på jeres harddisk (så I ved hvor I har den), det kunne fx. være i den mappe i har jeres andre studierelevante ting i, så som noter o.l.</p>
<p>Hvis I sørger for altid at åbne <em>virkstrat_netvaerk.Rproj</em> filen enten ved at dobbeltklikke på den, eller åbne den inde fra R-studio øverste højre hjørne (hvor den vil ligge som ‘recent projects’ hvis den <em>har</em> været åbnet før). Hvis ikke skal I finde den under <em>open project…</em> (hvor I ‘browser’ jer frem til der hvor filen ligger).</p>
</section>
<section id="installér-og-indlæs-pakker" class="level1">
<h1>Installér og indlæs pakker</h1>
<p>For at kunne lave de analyser vi gerne vil skal vi bruge en række forskellige pakker ud over det, der ligger i <em>base R</em>. Det gælder fx. <a href="https://www.tidyverse.org/packages/"><strong>tidyverse</strong></a>, som er en samling af R pakker specifikt designet til data analyse, <a href="https://igraph.org/"><strong>igraph</strong></a>, som er en pakke til netværksanalyse, <a href="https://ggraph.data-imaginist.com/"><strong>ggraph</strong></a> (en udvidelse til plot-pakken ggplot2 fra tidyverse), som gør det lettere at visualisere relationelle data som fx. netværk, <a href="https://rpkgs.datanovia.com/ggpubr/"><strong>ggpubr</strong></a>, (endnu en udvidelse til ggplot2), som tilføjer nogen funktionalitet ift at gøre ens plots mere lækre, læs: <strong><em>pub</em></strong>lication <strong><em>r</em></strong>eady!, samt <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">RColorBrewer</a>, som er en pakke der indeholder farvepaletter til valg af farver på plots.</p>
<p>En anden pakke, vi gerne vil bruge er <a href="https://docs.ropensci.org/writexl/"><strong>writexl</strong></a>, som gør det muligt at gemme Excel-filer fra R.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I R installeres pakker med funktionen <code>install.packages()</code>…</p>
<p>Hvis du har problemer med at installere tidyverse (især på macOS, vist)?, så prøv nedenstående:</p>
<ul>
<li>Luk R og RStudio</li>
<li>Åbne Terminal på din computer (Tryk Command + Mellemrum på tastaturet for at starte Spotlight -&gt; søg “Terminal” i Spotlight Search )</li>
<li>Skriv: sudo xcode-select –install i terminalen og så taste din password ind.</li>
<li>Åbne RStudio igen og prøv at installere tidyverse pakken igen med at skrive: install.packages(“tidyverse”)</li>
</ul>
</div>
</div>
<p>Det er <strong>kun</strong> nødvendigt at installere pakker <em>én</em> gang. Man kan sagtens lade kodelinjen stå i sit script, men sæt et # foran. Det betyder at koden ikke ‘køres’.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"igraph"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggraph"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"RColorBrewer"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Når vi skal bruge installerede pakker skal de ‘loades’, til det bruges funktionen <code>library()</code>.</p>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="tidyverse" class="level1">
<h1>Tidyverse</h1>
<p>I løbet af dette kursus kommer vi til at skrive kode på ‘tidyverse-måden’. Der findes rigtig mange gode tutorials på nettet, der introducerer til tidyverse, fx <a href="https://becoming-fluent-in-data.com/intro-to-tidyverse.html">denne</a> eller <a href="https://r4ds.hadley.nz/">denne</a>, men lad mig kort introducere nogle kerneideer og begreber/funktioner fra dette ‘univers’. Det er nemlig sådan at pakker i Tidyverse deler den samme underliggende filosofi i forhold til design, kode-grammatik og datastruktur.</p>
<div class="img-float">
<p><img src="images/tidyverse.png" class="img-fluid" style="float: left; ; margin: 5px; ;width:32.0%"></p>
</div>
<p>Tidyverse er en samling af pakker til R, som alle sammen er designet specielt til data science. De vigtigste pakker for os er:</p>
<p><u><strong>Indlæsning af data:</strong></u></p>
<p><strong>readr</strong> som indlæser kommaseparerede datafiler (fx csv-filer) og <strong>readxl</strong> som læser filer fra Excel (.xlsx). Denne pakke er ikke core-tidyverse, så den skal loades selvstændigt.</p>
<p><u><strong>Behandling af data:</strong></u></p>
<p><strong>dplyr</strong> som har en masse redskaber til data behandling</p>
<p><u><strong>Visualisering af data</strong>:</u></p>
<p><strong>ggplot2</strong> som har en masse funktioner til almindelig datavisualisering</p>
<section id="tidyverse-grammatikken" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-grammatikken">Tidyverse-grammatikken</h2>
<section id="læs-data-og-assign--" class="level3">
<h3 class="anchored" data-anchor-id="læs-data-og-assign--">Læs data og assign ‘&lt;-’</h3>
<p>Først indlæser vi noget data med <code>read_csv()</code>. I mappen data ligger et eksempeldatasæt med flyafgangstider i NYC 2013 (ja, hvorfor ikke).</p>
<p>Filen ligger i “data-mappen” i vores R-projekt.</p>
<p><a href="data/flights.csv" class="btn btn-primary">Download Data</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hvis I downloader datafilen (csv) her, så læg den i ‘data’-mappen i jeres Rprojekt-mappe</p>
</div>
</div>
<p>Vi giver <code>read_csv()</code> stien til filen “data/fligths.csv” (vi kan undlade alt foran data/ fordi vi er i et Rprojekt, som har et working directory. Dvs R ved hvor på computeren, vi befinder os). Hvis vi bare ‘kører’ koden får vi læst data ind, men ikke gemt i hukommelsen.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"data/flights.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 336776 Columns: 20
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(4): carrier, tailnum, origin, dest dbl (15): ...1, year, month, day, dep_time,
sched_dep_time, dep_delay, arr_... dttm (1): time_hour
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 20
    ...1  year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1     1  2013     1     1      517            515         2      830
 2     2  2013     1     1      533            529         4      850
 3     3  2013     1     1      542            540         2      923
 4     4  2013     1     1      544            545        -1     1004
 5     5  2013     1     1      554            600        -6      812
 6     6  2013     1     1      554            558        -4      740
 7     7  2013     1     1      555            600        -5      913
 8     8  2013     1     1      557            600        -3      709
 9     9  2013     1     1      557            600        -3      838
10    10  2013     1     1      558            600        -2      753
# ℹ 336,766 more rows
# ℹ 12 more variables: sched_arr_time &lt;dbl&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
#   flight &lt;dbl&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p>For at ‘gemme’ vores data i hukommelsen bruger vi ‘&lt;-’ assign operatoren. Det betyder at vi læser data ind, men nu assigner det til et <strong>objekt</strong>, som vi kalder <em>flights</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/flights.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="databehandling-med-dplyr" class="level3">
<h3 class="anchored" data-anchor-id="databehandling-med-dplyr">Databehandling med dplyr</h3>
<p><strong>dplyr</strong> delen af Tidyverse består blandt andet af en lang række funktioner (<strong>verber</strong>) som udgør det centrale element i gramatikken. De ‘gør’ noget med vores <strong>objekter</strong>. Generalt er strukturen i en tidyverse kode altid: 1. et data-objekt 2. en række verber 3. et nyt ændret data-objet. En elegant måde at skrive kode på er at bruge den såkaldte <em>pipe</em> operator <code>%&gt;%</code>. Den tager så at sige dét, der står til venstre, og sender videre til dét, der står til højre. Man kan skrive ‘pipen’ eller bruge en genvejstast som i Windows er <span style="background-color: #f2f2f2; box-sizing: border-box"><strong><code>Control + Shift + M</code></strong></span> og i MacOS <span style="background-color: #f2f2f2; box-sizing: border-box"><strong><code>Cmd + Shift + M</code></strong></span></p>
<p><img src="images/Screenshot from 2025-01-30 22-13-07.png" class="img-fluid" width="500"></p>
<p>Et simpelt verbum er fx. <code>head()</code>, som viser de første rækker af vores data</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 20
   ...1  year month   day dep_time sched_dep_time dep_delay arr_time
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1     1  2013     1     1      517            515         2      830
2     2  2013     1     1      533            529         4      850
3     3  2013     1     1      542            540         2      923
4     4  2013     1     1      544            545        -1     1004
5     5  2013     1     1      554            600        -6      812
6     6  2013     1     1      554            558        -4      740
# ℹ 12 more variables: sched_arr_time &lt;dbl&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
#   flight &lt;dbl&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p>eller <code>glimpse()</code>, der viser hvilke typer af variable etc vores objekt indeholder og samtidig giver eksempler på værdierne:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 336,776
Columns: 20
$ ...1           &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, …
$ year           &lt;dbl&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2…
$ month          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ day            &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ dep_time       &lt;dbl&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 558, …
$ sched_dep_time &lt;dbl&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 600, …
$ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2, -1…
$ arr_time       &lt;dbl&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 849,…
$ sched_arr_time &lt;dbl&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 851,…
$ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7, -1…
$ carrier        &lt;chr&gt; "UA", "UA", "AA", "B6", "DL", "UA", "B6", "EV", "B6", "…
$ flight         &lt;dbl&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301, 4…
$ tailnum        &lt;chr&gt; "N14228", "N24211", "N619AA", "N804JB", "N668DN", "N394…
$ origin         &lt;chr&gt; "EWR", "LGA", "JFK", "JFK", "LGA", "EWR", "EWR", "LGA",…
$ dest           &lt;chr&gt; "IAH", "IAH", "MIA", "BQN", "ATL", "ORD", "FLL", "IAD",…
$ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149, 1…
$ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 733, …
$ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 6…
$ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 0…
$ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-01 0…</code></pre>
</div>
</div>
<p>Vi kan inddele de mest almindelige verber i tre grupper: nogle der gør noget i forhold til <strong>rækker</strong>, nogle der gør noget i forhold til <strong>kolonner</strong> og nogle der gør noget i forhold til <strong>grupper</strong></p>
<section id="række-orienterede-verberfunktioner" class="level4">
<h4 class="anchored" data-anchor-id="række-orienterede-verberfunktioner">Række orienterede verber/funktioner</h4>
<p>Lad os starte med en af de verber vi kommer til at bruge hele tiden, <em><code>filter()</code></em>. I forhold til måden at skrive kode på tager vi vores data.objekt <code>flights</code> og sender det videre <code>%&gt;%</code> til verbet <code>filter()</code>, som filtrer data baseret på de betingelser vi giver det. <code>flights</code> indeholder en variable der hedder <code>dep_delay</code> (hvor meget var en afgang forsinket). Lad os sige vi kun vil se på de afgange der er forsinket med mere <code>&gt;</code> end tre timer (180 min). Vi kunne også have brugt andre betingesler, fx. mindre end, <code>&lt;</code>, eller lig med <code>==</code> (husk at vi altid bruger dobbelt =, når der er tale om logiske operationer), eller ikke lig med <code>!=</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dep_delay <span class="sc">&gt;</span> <span class="dv">180</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,893 × 20
    ...1  year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1   152  2013     1     1      848           1835       853     1001
 2   650  2013     1     1     1815           1325       290     2120
 3   674  2013     1     1     1842           1422       260     1958
 4   747  2013     1     1     2006           1630       216     2230
 5   802  2013     1     1     2115           1700       255     2330
 6   816  2013     1     1     2205           1720       285       46
 7   831  2013     1     1     2312           2000       192       21
 8   835  2013     1     1     2343           1724       379      314
 9  1243  2013     1     2     1244            900       224     1431
10  1279  2013     1     2     1332            904       268     1616
# ℹ 3,883 more rows
# ℹ 12 more variables: sched_arr_time &lt;dbl&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
#   flight &lt;dbl&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p>Igen vil vi gerne gemme det data der kommer ud. Lige nu har vi bare ‘vist’ det. Derfor assigner vi vores outcome til et nyt objekt <code>fligths_delayed</code>, som nu kun indeholder de rækker vi har bedt om, baseret på <code>dep_delay</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>flights_delayed <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dep_delay <span class="sc">&gt;</span> <span class="dv">180</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Vi kan også basere vores filter på mere end en betingelse. I så fald bruger vi enten <em>og</em> <code>&amp;</code> eller <em>eller</em> <code>|</code>, fx.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>flights_delayed <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dep_delay <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> dep_delay <span class="sc">&lt;</span> <span class="dv">120</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Hvor vi reducerer vores data med flyafgange til alle fly der er mere end en time <em>og</em> mindre end to timer forsinket.</p>
</section>
<section id="kolonne-orienterede-funktionerverber" class="level4">
<h4 class="anchored" data-anchor-id="kolonne-orienterede-funktionerverber">Kolonne orienterede funktioner/verber</h4>
<p>En funktion vi kommer til at bruge meget, og som svarer til <code>filter()</code>, men gælder kolonnerne, er <em><code>select()</code></em>. Med select vælger vi de variable vi vil beholde. Lad os reducere vores data, så vi kun har afgangs- og ankomststed samt år, måned, dag og forsinkelse.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(origin, dest, year, month, day, dep_delay)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  origin dest   year month   day dep_delay
  &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 EWR    IAH    2013     1     1         2
2 LGA    IAH    2013     1     1         4
3 JFK    MIA    2013     1     1         2
4 JFK    BQN    2013     1     1        -1
5 LGA    ATL    2013     1     1        -6
6 EWR    ORD    2013     1     1        -4</code></pre>
</div>
</div>
<p>En anden nyttig kolonne-funktion er <em><code>rename()</code></em>. Måske vil vi gerne kalde vores kolonner noget andet. I det her tilfælde kunne det være vi gerne ville have det på dansk. <code>rename()</code> fungerer på den måde at man skriver det nye navn og fortæller funktionen at det skal være lig med <code>=</code> det gamle navn. Bemærk at vi her <strong>ikke</strong> assigner vores output til noget objekt, vi ser bare de første par rækker, <code>head()</code>. Dvs. flights_reduced objektet forbliver uforandret</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">fra =</span> origin, <span class="at">til =</span> dest, å<span class="at">r =</span> year, måned <span class="ot">=</span> month, <span class="at">dag =</span> day, <span class="at">forsinkelse =</span> dep_delay) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 6
   fra   til      år måned   dag forsinkelse
   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
 1 EWR   IAH    2013     1     1           2
 2 LGA   IAH    2013     1     1           4
 3 JFK   MIA    2013     1     1           2
 4 JFK   BQN    2013     1     1          -1
 5 LGA   ATL    2013     1     1          -6
 6 EWR   ORD    2013     1     1          -4
 7 EWR   FLL    2013     1     1          -5
 8 LGA   IAD    2013     1     1          -3
 9 JFK   MCO    2013     1     1          -3
10 LGA   ORD    2013     1     1          -2
# ℹ 336,766 more rows</code></pre>
</div>
</div>
<p>Hvis vi lige kigger på <code>flights_reduced</code> med <code>head()</code> kan vi konstatere at variablene stadig har de engelske navme</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  origin dest   year month   day dep_delay
  &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 EWR    IAH    2013     1     1         2
2 LGA    IAH    2013     1     1         4
3 JFK    MIA    2013     1     1         2
4 JFK    BQN    2013     1     1        -1
5 LGA    ATL    2013     1     1        -6
6 EWR    ORD    2013     1     1        -4</code></pre>
</div>
</div>
<p>Hvis vi gerne vil tage en smutvej til det samme, kan man faktisk godt bruge <code>select()</code> til både at udvælge og omdøbe kolonner. Denne gang assigner vi outputet til et objekt som vi kalder det samme som før (dvs. vi overskriver det gamle)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="ot">&lt;-</span> flights_reduced <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">fra =</span> origin, <span class="at">til =</span> dest, å<span class="at">r =</span> year, måned <span class="ot">=</span> month, <span class="at">dag =</span> day, <span class="at">forsinkelse =</span> dep_delay)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  fra   til      år måned   dag forsinkelse
  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
1 EWR   IAH    2013     1     1           2
2 LGA   IAH    2013     1     1           4
3 JFK   MIA    2013     1     1           2
4 JFK   BQN    2013     1     1          -1
5 LGA   ATL    2013     1     1          -6
6 EWR   ORD    2013     1     1          -4</code></pre>
</div>
</div>
<p>Funktionen/verbet <em><code>mutate()</code></em> er anden vigtig funktion som vi skal bruge hele tiden. Med <code>mutate()</code> kan vi ‘ændre’ vores dataobjekt, fx. lave nye variable eller omskrive gamle. lad os sige vi gerne vil have en ny variabel der fortæller os om et fly er mere end en halv time forsinket. Her skriver vi navnet på den variable vi vil lave og fortæller hvad den skal bestå af. Med forsinkelse &gt; 30 laver vi en logisk variabel der <code>TRUE</code> hvis forsinkelsen er over 30 min ellers <code>FALSE</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="ot">&lt;-</span> flights_reduced <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">forsinket_halv_time =</span> forsinkelse <span class="sc">&gt;</span> <span class="dv">30</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  fra   til      år måned   dag forsinkelse forsinket_halv_time
  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;              
1 EWR   IAH    2013     1     1           2 FALSE              
2 LGA   IAH    2013     1     1           4 FALSE              
3 JFK   MIA    2013     1     1           2 FALSE              
4 JFK   BQN    2013     1     1          -1 FALSE              
5 LGA   ATL    2013     1     1          -6 FALSE              
6 EWR   ORD    2013     1     1          -4 FALSE              </code></pre>
</div>
</div>
<p>Nu har vores dataobjekt fået en ny variabel.</p>
</section>
<section id="grupper-og-opsummeringer" class="level4">
<h4 class="anchored" data-anchor-id="grupper-og-opsummeringer">Grupper og ‘opsummeringer’</h4>
<p>Hvis vi ikke bare vil ændre eller tilføje variable, men i stedet vil lave nogle beregninger på vores data, kan vi bruge verbet <code>summarise()</code>. Det kunne være vi gerne vil have den gennemsnitlige <code>mean()</code> forsinkelse på alle fly, og antallet af fly i det hele taget <code>n()</code> (tæller antal rækker), og antallet af fly, der er mere end en halv time forsinket:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">gens_forsinkelse =</span> <span class="fu">mean</span>(forsinkelse), <span class="at">fly =</span> <span class="fu">n</span>(), <span class="at">halv_time =</span> <span class="fu">sum</span>(forsinket_halv_time))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  gens_forsinkelse    fly halv_time
             &lt;dbl&gt;  &lt;int&gt;     &lt;int&gt;
1               NA 336776        NA</code></pre>
</div>
</div>
<p>Hov!!! Hvorfor får vi værdien <code>NA</code>. Det skyldes at der åbenbart er flyafgange i data, hvor der ikke er registretet en tid. <code>NA</code> er (en af) R’s måde(r) at håndtere <code>missing</code> værdier. Hvis vi gerne vil lave vores beregninger alligevel, skal vi specificere at der skal ses bort fra <code>missing</code>-værdier. Det gør vi ved at skrive <code>na.rm = TRUE</code> (læses som na.remove) i <code>mean()</code> og <code>sum()</code> funktionern. Lad os i den forbindelse også lige tilføje en beregning af andelen af fly der er mere end en halv tinme forsinket:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">gens_forsinkelse =</span> <span class="fu">mean</span>(forsinkelse, <span class="at">na.rm =</span> T),  <span class="at">fly =</span> <span class="fu">n</span>(), <span class="at">halv_time =</span> <span class="fu">sum</span>(forsinket_halv_time, <span class="at">na.rm =</span> T), <span class="at">halv_time_pct =</span> halv_time <span class="sc">/</span> fly)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  gens_forsinkelse    fly halv_time halv_time_pct
             &lt;dbl&gt;  &lt;int&gt;     &lt;int&gt;         &lt;dbl&gt;
1             12.6 336776     48291         0.143</code></pre>
</div>
</div>
<p>En sidste funktion der vil dukke op hele tiden er <code>group_by()</code>. Vi har lige opsummeret hele datasættet. Vi kunne jo i stedet være interesseret i at gruppere data før vi opsummerer. Det kunne fx være på måneder. Altså gennemsnitlig forsinkelse per måned. For at gøre det skal vi sætte verbet/funktionen <code>group_by()</code> ind før <code>summarise()</code>. Bemærk her at vi kan (men behøver ikke) lave linjeskift i koden efter en pipe.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(måned) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">gens_forsinkelse =</span> <span class="fu">mean</span>(forsinkelse, <span class="at">na.rm =</span> T),  <span class="at">fly =</span> <span class="fu">n</span>(), <span class="at">halv_time =</span> <span class="fu">sum</span>(forsinket_halv_time, <span class="at">na.rm =</span> T), <span class="at">halv_time_pct =</span> halv_time <span class="sc">/</span> fly) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   måned gens_forsinkelse   fly halv_time halv_time_pct
   &lt;dbl&gt;            &lt;dbl&gt; &lt;int&gt;     &lt;int&gt;         &lt;dbl&gt;
 1     1            10.0  27004      3350        0.124 
 2     2            10.8  24951      3182        0.128 
 3     3            13.2  28834      4309        0.149 
 4     4            13.9  28330      4531        0.160 
 5     5            13.0  28796      4416        0.153 
 6     6            20.8  28243      5717        0.202 
 7     7            21.7  29425      6173        0.210 
 8     8            12.6  29327      4238        0.145 
 9     9             6.72 27574      2419        0.0877
10    10             6.24 28889      2697        0.0934
11    11             5.44 27268      2388        0.0876
12    12            16.6  28135      4871        0.173 </code></pre>
</div>
</div>
<p>Man kan også gruppere data ud fra mere end en variabel. Vi kunne fx se på hvilke stærkninger, altså <code>fra</code> <code>til</code>, der er mest forsinkede. Her introduceres desuden en anden meget anvendlig funktion, nemlig <code>arrange()</code>, der sorterer data på en given variabel. Hvis vi bruger <code>desc()</code> omkring variable sorterer den faldende (dvs. fra størt til mindst, ellers sorterer den altid fra mindst til størst):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>flights_reduced <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fra, til) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">gens_forsinkelse =</span> <span class="fu">mean</span>(forsinkelse, <span class="at">na.rm =</span> T),  <span class="at">fly =</span> <span class="fu">n</span>(), <span class="at">halv_time =</span> <span class="fu">sum</span>(forsinket_halv_time, <span class="at">na.rm =</span> T), <span class="at">halv_time_pct =</span> halv_time <span class="sc">/</span> fly) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(gens_forsinkelse))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fra'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 224 × 6
# Groups:   fra [3]
   fra   til   gens_forsinkelse   fly halv_time halv_time_pct
   &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;int&gt;     &lt;int&gt;         &lt;dbl&gt;
 1 EWR   TYS               41.8   323       121         0.375
 2 EWR   CAE               36.3   104        33         0.317
 3 EWR   TUL               34.9   315       112         0.356
 4 LGA   SBN               31.3     6         3         0.5  
 5 EWR   OKC               30.6   346       112         0.324
 6 LGA   BHM               29.8   296        88         0.297
 7 LGA   CAE               29.5    12         4         0.333
 8 EWR   DSM               29.3   411       121         0.294
 9 EWR   JAC               28.7    23         6         0.261
10 EWR   ROC               27.9   513       147         0.287
# ℹ 214 more rows</code></pre>
</div>
</div>
<p>Det er åbenbart forbindelsen fra Newark Liberty International Airport til McGhee Tyson Lufthavn der oplever mest forsinkelse. I gennemsnit ca. 42 min og 37.5% er mere end en halv time forsinket…</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Take-away</strong></p>
<p>Her har vi set på hvordan vi indlæser data med <code>read_csv()</code>, og hvordan vi assigner data til et objekt med <code>&lt;-</code>. Vi har også introduceret <code>%&gt;%</code> - <em>pipen</em> - som vi sender videre fra vensstre mod højre. Vi har desuden set på funktionaliteten i <code>dplyr</code>:</p>
<p>Af <strong>række-funktioner</strong> har vi introduceret <code>filter()</code>, som bruges til at udvælge specifikke rækker baseret på logiske betingelser <code>&gt;, &lt;, ==, !=</code>, eller kombinationer af disse med <code>&amp;, |</code>.</p>
<p>Af <strong>kolonne-funktioner</strong> har vi introduceret <code>select()</code> og <code>rename()</code>, til at udvælge og eller omdøbe variable. Desuden har vi snuset til <code>mutate()</code>-funktionen som vi bruger til at ændre eller tilføje variable.</p>
<p>På <strong>gruppe-niveauet</strong> har vi introduceret <code>summarise()</code> som for sig selv tilader opsummerende beregniger over hele data (opfattet som én gruppe), men som i kombination med <code>group_by()</code> kan lave opsummeringer baseret på en eller flere variable, der grupperer data.</p>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>